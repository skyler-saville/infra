repos:
  - repo: https://github.com/mvdan/sh
    rev: v3.11.0
    hooks:
      - id: shfmt
        args: ["-w", "-i", "2", "-ci", "-sr", "-ln=bash"]
        files: ^(deploy-tools/bin|scripts|lib)/.*\.sh$
      - id: shellcheck
        files: ^(deploy-tools/bin|scripts|lib)/.*\.sh$

  - repo: https://github.com/gitleaks/gitleaks
    rev: v8.24.2
    hooks:
      - id: gitleaks
        name: gitleaks-secret-scan
        args: ["protect", "--staged", "--redact"]

  - repo: local
    hooks:
      - id: lint-scripts
        name: lint-scripts
        entry: make lint-scripts
        language: system
        pass_filenames: false
        stages: [pre-commit]
      - id: validate-config
        name: validate-config
        entry: python3 scripts/validate-config.py
        language: system
        pass_filenames: false
      - id: validate-sensitive-file-exclusions
        name: validate-sensitive-file-exclusions
        entry: scripts/check-sensitive-files-excluded.sh
        language: system
        pass_filenames: false
      - id: test-scripts-pre-push
        name: test-scripts (optional pre-push)
        entry: make test-scripts
        language: system
        pass_filenames: false
        stages: [pre-push]
